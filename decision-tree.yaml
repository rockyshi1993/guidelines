# AI å†³ç­–æ ‘é…ç½®æ–‡ä»¶ v1.0.0
# ç”¨äºå¿«é€Ÿåœºæ™¯è¯†åˆ«å’Œå¼ºåˆ¶è§„åˆ™æ‰§è¡Œ

version: "1.0.0"
last_updated: "2025-11-11"
description: "AI åŠ©æ‰‹æ‰§è¡Œè§„èŒƒçš„ç»“æ„åŒ–å†³ç­–æ ‘"

# ===========================================
# åœºæ™¯å®šä¹‰ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
# ===========================================
scenarios:
  # åœºæ™¯ 0: é¡¹ç›®è§„èŒƒå¼ºåˆ¶æ£€æŸ¥ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
  scene_0:
    name: "é¡¹ç›®è§„èŒƒå¼ºåˆ¶æ£€æŸ¥"
    priority: "P0"
    trigger:
      - "ä»»ä½•ä»£ç å®ç°ä»»åŠ¡"
      - "åˆ›å»º/ä¿®æ”¹æºä»£ç "
      - "åˆ›å»º/ä¿®æ”¹æµ‹è¯•"
      - "åˆ›å»º/ä¿®æ”¹ç¤ºä¾‹"
      - "åˆ›å»º/ä¿®æ”¹æ–‡æ¡£ï¼ˆå«ä»£ç ï¼‰"
    
    mandatory_steps:
      - step: 1
        action: "è¯†åˆ«é¡¹ç›®åç§°"
        methods:
          - priority: 1
            source: "ç”¨æˆ·æ˜ç¡®æåˆ°"
            extract: "ä»è¯·æ±‚ä¸­æå–å…³é”®è¯"
          - priority: 2
            source: "å½“å‰å·¥ä½œç›®å½•"
            pattern: "D:\\Project\\<project>\\"
          - priority: 3
            source: "æ–‡ä»¶è·¯å¾„"
            pattern: "D:\\Project\\<project>\\..."
          - priority: 4
            source: "è¯¢é—®ç”¨æˆ·"
            action: "åˆ—å‡ºå¯ç”¨é¡¹ç›®"
      
      - step: 2
        action: "read_file"
        target: "guidelines/profiles/<project>.md"
        requirement: "å®Œæ•´é€šè¯»ï¼Œä¸å¾—è·³è¿‡"
      
      - step: 3
        action: "æå–å¼ºåˆ¶è§„èŒƒ"
        extract:
          - "ç¦æ­¢é¡¹ï¼ˆServiceå±‚/DTO/æµ‹è¯•æ¡†æ¶ç­‰ï¼‰"
          - "å¼ºåˆ¶é¡¹ï¼ˆJoi/Mocha/utilsCrudç­‰ï¼‰"
          - "æµ‹è¯•è§„èŒƒï¼ˆç›®å½•/æ¡†æ¶/æ–­è¨€åº“/å‘½åï¼‰"
          - "MCP é…ç½®ï¼ˆå¦‚æ¶‰åŠæ•°æ®åº“æ“ä½œï¼‰"
          - "æ¶æ„è§„èŒƒ"
          - "ç¼–ç è§„èŒƒ"
      
      - step: 4
        action: "å†²çªæ£€æŸ¥"
        rule: "Profile è§„èŒƒ > é€šç”¨æœ€ä½³å®è·µ"
        conflicts:
          - "Profile: ç¦æ­¢Serviceå±‚ vs é€šç”¨å®è·µ: æ¨èServiceå±‚ â†’ éµå®ˆProfile âœ…"
          - "Profile: å¼ºåˆ¶Joi vs é€šç”¨å®è·µ: æ¨èclass-validator â†’ éµå®ˆProfile âœ…"
          - "Profile: å¼ºåˆ¶Mocha vs é€šç”¨å®è·µ: æ¨èJest â†’ éµå®ˆProfile âœ…"
      
      - step: 5
        action: "è‡ªæˆ‘æ£€æŸ¥"
        questions:
          - question: "æˆ‘æ˜¯å¦å·²è¯»å–é¡¹ç›®Profileï¼Ÿ"
            must_be: "YES"
          - question: "æˆ‘æ˜¯å¦çŸ¥é“é¡¹ç›®ç¦æ­¢ä»€ä¹ˆï¼Ÿ"
            must_be: "YES"
          - question: "æˆ‘æ˜¯å¦ä¼šä½¿ç”¨é¡¹ç›®ç¦æ­¢çš„æŠ€æœ¯ï¼Ÿ"
            must_be: "NO"
          - question: "æˆ‘æ˜¯å¦ä¼˜å…ˆé¡¹ç›®è§„èŒƒè€Œéé€šç”¨å®è·µï¼Ÿ"
            must_be: "YES"
          - question: "æˆ‘æ˜¯å¦éœ€è¦é‡æ–°è¯»å–Profileï¼Ÿ"
            must_be: "NO"
        all_must_pass: true
      
      - step: 6
        action: "è¾“å‡ºéªŒè¯ç»“æœ"
        format: "åœºæ™¯0æ‰§è¡Œç»“æœæ¨¡æ¿"
        required_sections:
          - "é¡¹ç›®åç§°/Profileè·¯å¾„"
          - "ç¦æ­¢é¡¹åˆ—è¡¨ï¼ˆæˆ–æ ‡æ³¨æ— ï¼‰"
          - "å¼ºåˆ¶é¡¹åˆ—è¡¨ï¼ˆæˆ–æ ‡æ³¨ä½¿ç”¨é€šç”¨è§„èŒƒï¼‰"
          - "5ä¸ªè‡ªæˆ‘æ£€æŸ¥ç»“æœ"
          - "æ‰§è¡Œè®¡åˆ’"
          - "æœ€ç»ˆç¡®è®¤ï¼ˆé€šè¿‡/å¤±è´¥ï¼‰"
    
    failure_handling:
      condition: "ä»»ä½•è‡ªæˆ‘æ£€æŸ¥ä¸º NO"
      action: "HALT"
      message: "åœºæ™¯0æ£€æŸ¥å¤±è´¥ï¼Œéœ€è¦é‡æ–°æ‰§è¡Œ STEP 1-5"
      must_not: ["ç»§ç»­å†™ä»£ç ", "åˆ›å»ºä»»ä½•æ–‡ä»¶", "æ‰§è¡Œåç»­æ­¥éª¤"]
    
    next: "ç»§ç»­ä»»åŠ¡ï¼ˆåœºæ™¯ A/B/C/D/E/Fï¼‰"
  
  # åœºæ™¯ 0.5: å®æ—¶æ£€æŸ¥ï¼ˆè¾¹å†™è¾¹æ£€ï¼Œæ™ºèƒ½è§¦å‘ï¼‰
  scene_0_5:
    name: "å®æ—¶æ£€æŸ¥æœºåˆ¶"
    priority: "P0"
    trigger:
      - "åœºæ™¯0é€šè¿‡åï¼Œå¼€å§‹ç¼–å†™ä»£ç "
      - "å®Œæˆä¸€ä¸ªæ–‡ä»¶çš„åˆ›å»ºï¼ˆcreate_fileï¼‰"
      - "å®Œæˆä¸€ä¸ªæ–‡ä»¶çš„ä¿®æ”¹ï¼ˆreplace_string_in_fileï¼‰"
    
    check_items:
      - id: 1
        name: "æ¶æ„å±‚æ¬¡è¿è§„"
        checks:
          - condition: "Profileç¦æ­¢Serviceå±‚ AND æ–‡ä»¶è·¯å¾„åŒ…å« 'service'"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³åˆ é™¤æ–‡ä»¶", "é‡æ„ä¸º Utils æ¨¡å¼", "è¾“å‡ºä¿®æ­£ç»“æœ"]
          - condition: "Profileç¦æ­¢DTO AND æ–‡ä»¶è·¯å¾„åŒ…å« 'dto'"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³åˆ é™¤æ–‡ä»¶", "æ”¹ç”¨ Joi schema", "è¾“å‡ºä¿®æ­£ç»“æœ"]
          - condition: "Profileç¦æ­¢Repository AND æ–‡ä»¶è·¯å¾„åŒ…å« 'repository'"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³ä¿®æ­£"]
      
      - id: 2
        name: "æŠ€æœ¯æ ˆè¿è§„"
        checks:
          - condition: "Profileå¼ºåˆ¶Joi AND æ–‡ä»¶ä¸­ä½¿ç”¨ 'class-validator'"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³æ›¿æ¢ä¸º Joi", "è¾“å‡ºä¿®æ­£ç»“æœ"]
          - condition: "Profileå¼ºåˆ¶Mocha AND æ–‡ä»¶ä¸­ä½¿ç”¨ 'jest'"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³æ›¿æ¢ä¸º Mocha", "è¾“å‡ºä¿®æ­£ç»“æœ"]
          - condition: "Profileå¼ºåˆ¶utilsCrud AND æ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨ Mongoose æ–¹æ³•"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "æç¤ºç¡®è®¤æ˜¯å¦åº”ä½¿ç”¨utilsCrud"]
      
      - id: 3
        name: "ç¼–ç è§„èŒƒè¿è§„"
        checks:
          - condition: "Profileè¦æ±‚ä¸­æ–‡æ³¨é‡Š AND æ–‡ä»¶ä¸­å­˜åœ¨è‹±æ–‡æ³¨é‡Š"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³ç¿»è¯‘ä¸ºä¸­æ–‡", "è¾“å‡ºä¿®æ­£ç»“æœ"]
          - condition: "Profileè¦æ±‚ç‰¹å®šå‘½åè§„èŒƒ AND æ–‡ä»¶å‘½åä¸ç¬¦åˆ"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³ä¿®æ­£"]
      
      - id: 4
        name: "æ–‡ä»¶å‘½åè¿è§„"
        checks:
          - condition: "Profileè¦æ±‚snake_case AND æ–‡ä»¶ä½¿ç”¨ kebab-case/camelCase/PascalCase"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³é‡å‘½å", "è¾“å‡ºä¿®æ­£ç»“æœ"]
      
      - id: 5
        name: "æ¥å£æ–‡æ¡£ç¼ºå¤±"
        checks:
          - condition: "åˆ›å»ºControlleræ–‡ä»¶ AND æœªåˆ›å»ºå¯¹åº”æ¥å£æ–‡æ¡£"
            action: ["è¾“å‡ºè¿è§„è­¦å‘Š", "ç«‹å³åˆ›å»ºæ¥å£æ–‡æ¡£", "è¾“å‡ºä¿®æ­£ç»“æœ"]
          - condition: "ä¿®æ”¹Controlleræ–‡ä»¶ AND æ¥å£æ–‡æ¡£æœªåŒæ­¥"
            action: ["è¾“å‡ºæç¤º", "æé†’ç¡®è®¤æ˜¯å¦éœ€è¦æ›´æ–°æ–‡æ¡£"]
    
    output_strategy:
      single_file_mode:
        condition: "è¿ç»­åˆ›å»º â‰¤3 ä¸ªæ–‡ä»¶"
        format: "æ¯ä¸ªæ–‡ä»¶ç‹¬ç«‹è¾“å‡ºæ£€æŸ¥ç»“æœ"
        sections:
          - "æ¶æ„å±‚æ¬¡"
          - "æŠ€æœ¯æ ˆ"
          - "ç¼–ç è§„èŒƒ"
          - "æ–‡ä»¶å‘½å"
          - "æ¥å£æ–‡æ¡£"
      
      batch_mode:
        condition: "è¿ç»­åˆ›å»º >3 ä¸ªæ–‡ä»¶"
        format: "æ‰¹é‡æ±‡æ€»è¾“å‡º"
        sections:
          - "ç¬¦åˆè§„èŒƒæ–‡ä»¶æ•°é‡"
          - "å‘ç°è¿è§„æ–‡ä»¶æ•°é‡"
          - "è¿è§„æ–‡ä»¶æ¸…å•"
    
    next: "ç»§ç»­å½“å‰ä»»åŠ¡"
  
  # åœºæ™¯ A: åŠŸèƒ½æ–°å¢/ä¿®æ”¹
  scene_A:
    name: "åŠŸèƒ½æ–°å¢/ä¿®æ”¹"
    priority: "P1"
    trigger:
      - "ä¿®æ”¹ src/lib/ ä¸­çš„ä»£ç "
      - "æ–°å¢/ä¿®æ”¹ APIã€å‡½æ•°ã€æ¨¡å—"
    dependencies: ["scene_0"]
    
    mandatory_steps:
      - step: 1
        action: "ç¼–å†™æµ‹è¯•"
        location: "test/<åŠŸèƒ½>.test.js"
        coverage: ["æ­£å¸¸è·¯å¾„", "å¼‚å¸¸è·¯å¾„", "è¾¹ç•Œç”¨ä¾‹"]
        check_profile: true
      
      - step: 2
        action: "æä¾›ç¤ºä¾‹"
        location: "examples/<åŠŸèƒ½>.examples.js"
        requirements: ["å¯ç‹¬ç«‹è¿è¡Œ", "è¯¦ç»†æ³¨é‡Š"]
      
      - step: 3
        action: "æ›´æ–°æ–‡æ¡£"
        files:
          - "CHANGELOG.md [Unreleased]"
          - "README.mdï¼ˆå¦‚æœAPIå˜æ›´ï¼‰"
          - "STATUS.mdï¼ˆå¦‚æœçŠ¶æ€å˜åŒ–ï¼‰"
          - "index.d.tsï¼ˆå¦‚é€‚ç”¨ï¼‰"
      
      - step: 4
        action: "è¿è¡ŒéªŒè¯"
        commands:
          - "npm test"
          - "node examples/<åŠŸèƒ½>.examples.js"
    
    reference: "guidelines/v2.md ç¬¬3.1ç« "
  
  # åœºæ™¯ B: Bug ä¿®å¤
  scene_B:
    name: "Bug ä¿®å¤"
    priority: "P1"
    trigger:
      - "ç”¨æˆ·æŠ¥å‘Šé”™è¯¯"
      - "å‘ç°å¼‚å¸¸è¡Œä¸º"
      - "ä¿®å¤ç¼ºé™·"
    dependencies: ["scene_0"]
    
    mandatory_steps:
      - step: 1
        action: "ä½¿ç”¨Bugæ¨¡æ¿"
        template: "guidelines/templates/bug-fix-analysis-template.md"
      
      - step: 2
        action: "è®°å½•åˆ†æ"
        location: "<é¡¹ç›®>/bug-analysis/YYYY-MM-DD-æè¿°.md"
        required_fields: ["æ ¹æœ¬åŸå› ", "å½±å“å¯¹æ¯”", "ä¿®å¤æ–¹æ¡ˆ", "éªŒè¯æ–¹æ³•"]
      
      - step: 3
        action: "æ·»åŠ å›å½’æµ‹è¯•"
        purpose: "é˜²æ­¢å†æ¬¡å‘ç”Ÿ"
      
      - step: 4
        action: "æ›´æ–°CHANGELOG"
        type: "Fixed"
    
    reference: "guidelines/templates/bug-fix-analysis-template.md"
  
  # MCP è°ƒç”¨æ£€æŸ¥ï¼ˆç‰¹æ®Šåœºæ™¯ï¼‰
  mcp_check:
    name: "MCP è°ƒç”¨å‰ç½®æ£€æŸ¥"
    priority: "P0"
    trigger:
      - "ç”¨æˆ·æ˜ç¡®è¦æ±‚æŸ¥è¯¢/åˆ†æ/ä¿®æ”¹æ•°æ®åº“æ•°æ®"
      - "é—®é¢˜è¯Šæ–­éœ€è¦æŸ¥çœ‹å®é™…æ•°æ®"
      - "æ•°æ®æ¢ç´¢ä¸åˆ†æ"
    
    mandatory_steps:
      - step: 1
        action: "è¯†åˆ«é¡¹ç›®ä¸Šä¸‹æ–‡"
        source: ["ç”¨æˆ·è¯·æ±‚", "å½“å‰ç›®å½•", "ä¸Šä¸‹æ–‡æ¨æ–­"]
      
      - step: 2
        action: "read_file"
        target: "guidelines/profiles/<project>.md"
        section: "MCP é…ç½®"
      
      - step: 3
        action: "æ£€æŸ¥MCPé…ç½®"
        validation:
          - check: "æ˜¯å¦å­˜åœ¨ MCP é…ç½®ç« èŠ‚"
            if_not_found:
              action: "REJECT"
              message: "è¯¥é¡¹ç›®æœªé…ç½® MCP æœåŠ¡å™¨ï¼Œæ— æ³•æ‰§è¡Œæ•°æ®åº“æ“ä½œ"
          - check: "å…è®¸çš„ MCP æœåŠ¡å™¨åç§°"
            extract: "allowed_servers"
          - check: "æ•°æ®åº“åç§°"
            extract: "database"
      
      - step: 4
        action: "éªŒè¯æƒé™"
        rule: "ä»…è°ƒç”¨ Profile ä¸­å£°æ˜çš„ MCP æœåŠ¡å™¨"
        forbidden: ["æœªå£°æ˜çš„ MCP", "è·¨é¡¹ç›®æ•°æ®åº“", "æœªæˆæƒæ“ä½œ"]
    
    failure_handling:
      condition: "Profile ä¸­æ—  MCP é…ç½®"
      action: "REJECT"
      message: "è¯¥é¡¹ç›®æœªé…ç½® MCP æœåŠ¡å™¨ï¼Œç¦æ­¢è°ƒç”¨ä»»ä½• MCP"
    
    reference: "copilot-instructions.md åœºæ™¯G"

# ===========================================
# å¼ºåˆ¶æ–­ç‚¹ï¼ˆMUST HALTï¼‰
# ===========================================
breakpoints:
  breakpoint_1:
    name: "åœºæ™¯0æœªé€šè¿‡"
    condition: "è‡ªæˆ‘æ£€æŸ¥5ä¸ªé—®é¢˜ä¸­ä»»ä½•ä¸€ä¸ªä¸º NO"
    action: "HALT"
    must_do:
      - "ğŸ›‘ ç«‹å³åœæ­¢å½“å‰ä»»åŠ¡"
      - "ğŸ”´ ä¸å¾—ç»§ç»­ç¼–å†™ä»£ç "
      - "ğŸ”´ ä¸å¾—åˆ›å»ºä»»ä½•æ–‡ä»¶"
      - "âœ… è¾“å‡º: åœºæ™¯0æ£€æŸ¥å¤±è´¥ï¼Œéœ€è¦é‡æ–°æ‰§è¡Œ"
      - "âœ… é‡æ–°æ‰§è¡Œ STEP 1-5"
  
  breakpoint_2:
    name: "Profileä¸å­˜åœ¨"
    condition: "guidelines/profiles/<project>.md ä¸å­˜åœ¨"
    action: "HALT"
    must_do:
      - "ğŸ›‘ ç«‹å³åœæ­¢"
      - "âŒ ä¸å¾—ä½¿ç”¨é»˜è®¤è§„èŒƒ"
      - "âœ… è¯¢é—®ç”¨æˆ·: è¯·æä¾›é¡¹ç›®åç§°æˆ–åˆ›å»º Profile"
  
  breakpoint_3:
    name: "æµ‹è¯•ç›®å½•å†²çª"
    condition: "Profileè§„å®šç›®å½• != è®¡åˆ’åˆ›å»ºçš„ç›®å½•"
    action: "HALT"
    must_do:
      - "ğŸ›‘ ç«‹å³åœæ­¢"
      - "ğŸ”´ è¾“å‡º: æµ‹è¯•ç›®å½•ä¸ç¬¦åˆ Profile è§„èŒƒ"
      - "âœ… æ˜¾ç¤º: Profile è¦æ±‚ vs å½“å‰è®¡åˆ’"
      - "âœ… ç­‰å¾…ç”¨æˆ·ç¡®è®¤"
  
  breakpoint_4:
    name: "ä½¿ç”¨ç¦æ­¢çš„æŠ€æœ¯æ ˆ"
    condition: "ä»£ç ä¸­ä½¿ç”¨äº† Profile ç¦æ­¢çš„åº“/æ¡†æ¶"
    action: "HALT"
    must_do:
      - "ğŸ›‘ ç«‹å³åœæ­¢"
      - "ğŸ”´ å›æ»šå·²åˆ›å»ºçš„æ–‡ä»¶"
      - "âœ… è¾“å‡º: æ£€æµ‹åˆ°ç¦æ­¢çš„æŠ€æœ¯æ ˆ"
      - "âœ… æ˜¾ç¤º: Profile ç¦æ­¢é¡¹ vs å½“å‰ä½¿ç”¨"
      - "âœ… ä½¿ç”¨å…è®¸çš„æŠ€æœ¯é‡æ–°å®ç°"
  
  breakpoint_5:
    name: "MCPæœªæˆæƒ"
    condition: "å°è¯•è°ƒç”¨æœªåœ¨ Profile ä¸­å£°æ˜çš„ MCP"
    action: "REJECT"
    must_do:
      - "ğŸ›‘ æ‹’ç»è°ƒç”¨"
      - "âŒ ä¸å¾—æ‰§è¡Œä»»ä½• MCP æ“ä½œ"
      - "âœ… è¾“å‡º: è¯¥é¡¹ç›®æœªé…ç½®æ­¤ MCP æœåŠ¡å™¨"
      - "âœ… æç¤º: è¯·åœ¨ Profile ä¸­æ·»åŠ  MCP é…ç½®"

# ===========================================
# å¿«é€ŸæŸ¥è¯¢è¡¨
# ===========================================
quick_reference:
  # æµ‹è¯•ç›®å½•å†³ç­–
  test_directory:
    priority: "Profile > é»˜è®¤"
    check_order:
      1: "è¯»å– Profile çš„æµ‹è¯•è§„èŒƒç« èŠ‚"
      2: "100% éµå®ˆ Profile è§„å®š"
      3: "ç¦æ­¢åœ¨æœªæˆæƒç›®å½•åˆ›å»ºæµ‹è¯•"
    default_fallback: "test/unit/features/"
    forbidden:
      - "åœ¨ Profile æœªæˆæƒçš„ç›®å½•åˆ›å»º"
      - "è‡ªä½œä¸»å¼ ä¼˜åŒ–ç›®å½•ç»“æ„"
  
  # æµ‹è¯•æ¡†æ¶å†³ç­–
  test_framework:
    priority: "Profile > é»˜è®¤"
    check_order:
      1: "è¯»å– Profile çš„æµ‹è¯•æ¡†æ¶ç« èŠ‚"
      2: "ä½¿ç”¨ Profile æŒ‡å®šçš„æ¡†æ¶"
      3: "ä½¿ç”¨ Profile æŒ‡å®šçš„æ–­è¨€åº“"
    default_fallback: "Vitest / Jest"
    forbidden:
      - "æ··ç”¨æ–­è¨€åº“"
      - "ä½¿ç”¨ Profile æœªæˆæƒçš„æ¡†æ¶"
  
  # MCP æœåŠ¡å™¨å†³ç­–
  mcp_server:
    priority: "Profile å¼ºåˆ¶"
    check_order:
      1: "è¯»å– Profile çš„ MCP é…ç½®ç« èŠ‚"
      2: "ç¡®è®¤å…è®¸çš„ MCP æœåŠ¡å™¨åç§°"
      3: "ä»…è°ƒç”¨å·²å£°æ˜çš„æœåŠ¡å™¨"
    no_config: "ç¦æ­¢è°ƒç”¨ä»»ä½• MCP"
    forbidden:
      - "æœªè¯»å– Profile å°±è°ƒç”¨ MCP"
      - "è°ƒç”¨æœªå£°æ˜çš„ MCP æœåŠ¡å™¨"
      - "è·¨é¡¹ç›®ä½¿ç”¨æ•°æ®åº“"
  
  # æ–‡æ¡£æ›´æ–°å†³ç­–
  documentation:
    mandatory_update:
      - "ä¿®æ”¹å…¬å¼€APIï¼ˆå‡½æ•°ç­¾å/å‚æ•°/è¿”å›å€¼ï¼‰"
      - "ä¿®æ”¹é»˜è®¤å€¼"
      - "ä¿®æ”¹é…ç½®é¡¹"
      - "ä¿®æ”¹è¡Œä¸ºé€»è¾‘"
      - "ä¿®æ”¹ç¤ºä¾‹ä»£ç "
    files:
      - "CHANGELOG.md [Unreleased] (å¼ºåˆ¶)"
      - "README.md (å¦‚æœå½±å“ç”¨æˆ·)"
      - "STATUS.md (å¦‚æœçŠ¶æ€å˜åŒ–)"
      - "index.d.ts (å¦‚é€‚ç”¨)"
    optional_update:
      - "å†…éƒ¨é‡æ„ï¼ˆä¸æ”¹APIï¼‰"
      - "æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸æ”¹è¡Œä¸ºï¼‰"

# ===========================================
# é¢„æ£€æŸ¥è§„åˆ™ï¼ˆPre-Flight Checkï¼‰
# ===========================================
preflight_checks:
  before_create_file:
    trigger: "è°ƒç”¨ create_file ä¹‹å‰"
    checks:
      - check: "æ–‡ä»¶è·¯å¾„æ˜¯å¦ç¬¦åˆ Profileï¼Ÿ"
        compare: "è®¡åˆ’è·¯å¾„ vs Profile è§„å®š"
      - check: "æ–‡ä»¶å‘½åæ˜¯å¦ç¬¦åˆ Profileï¼Ÿ"
        compare: "snake_case vs kebab-case vs camelCase"
      - check: "ä½¿ç”¨çš„æŠ€æœ¯æ ˆæ˜¯å¦è¢«ç¦æ­¢ï¼Ÿ"
        compare: "ä»£ç å†…å®¹ vs Profile ç¦æ­¢é¡¹"
      - check: "æµ‹è¯•ç›®å½•æ˜¯å¦æˆæƒï¼Ÿ"
        compare: "test/ è·¯å¾„ vs Profile æµ‹è¯•è§„èŒƒ"
    
    action_if_fail: "REJECT_AND_CORRECT"
    example: |
      è®¡åˆ’åˆ›å»º: test/app/controller/user.test.js
      Profile è¦æ±‚: test/unit/features/
      âŒ è·¯å¾„ä¸ç¬¦ â†’ æ‹’ç»åˆ›å»º â†’ ä¿®æ­£ä¸º test/unit/features/user.test.js
      âœ… é‡æ–°æ£€æŸ¥ â†’ é€šè¿‡ â†’ å…è®¸åˆ›å»º
  
  before_mcp_call:
    trigger: "è°ƒç”¨ä»»ä½• MCP å·¥å…·ä¹‹å‰"
    checks:
      - check: "Profile ä¸­æ˜¯å¦æœ‰ MCP é…ç½®ï¼Ÿ"
        if_not: "REJECT"
      - check: "MCP æœåŠ¡å™¨åç§°æ˜¯å¦åœ¨å…è®¸åˆ—è¡¨ï¼Ÿ"
        if_not: "REJECT"
      - check: "æ•°æ®åº“åç§°æ˜¯å¦åŒ¹é…ï¼Ÿ"
        if_not: "WARN"
    
    action_if_fail: "REJECT_WITH_MESSAGE"

# ===========================================
# é”™è¯¯æ¢å¤æµç¨‹
# ===========================================
recovery_procedures:
  error_1:
    name: "åœ¨é”™è¯¯ç›®å½•åˆ›å»ºäº†æµ‹è¯•æ–‡ä»¶"
    detection: "åœºæ™¯0.5å®æ—¶æ£€æŸ¥å‘ç°è·¯å¾„ä¸ç¬¦"
    steps:
      - "åˆ é™¤é”™è¯¯æ–‡ä»¶: Remove-Item <é”™è¯¯è·¯å¾„>"
      - "é‡æ–°è¯»å– Profile æµ‹è¯•è§„èŒƒ"
      - "åœ¨æ­£ç¡®ä½ç½®é‡æ–°åˆ›å»º"
      - "è¾“å‡º: âœ… å·²ä¿®æ­£: ä» <é”™è¯¯è·¯å¾„> ç§»åŠ¨åˆ° <æ­£ç¡®è·¯å¾„>"
  
  error_2:
    name: "ä½¿ç”¨äº†ç¦æ­¢çš„æŠ€æœ¯æ ˆ"
    detection: "ä»£ç ä¸­åŒ…å« Profile ç¦æ­¢çš„åº“/æ¡†æ¶"
    steps:
      - "å›æ»šä»£ç æ›´æ”¹"
      - "é‡æ–°è¯»å– Profile å¼ºåˆ¶é¡¹"
      - "ä½¿ç”¨å…è®¸çš„æŠ€æœ¯é‡æ–°å®ç°"
      - "è¾“å‡º: âœ… å·²ä¿®æ­£: ä» <ç¦æ­¢æŠ€æœ¯> æ”¹ä¸º <å…è®¸æŠ€æœ¯>"
  
  error_3:
    name: "è°ƒç”¨äº†æœªæˆæƒçš„ MCP"
    detection: "MCP æœåŠ¡å™¨åç§°ä¸åœ¨ Profile å…è®¸åˆ—è¡¨"
    steps:
      - "ç»ˆæ­¢ MCP è°ƒç”¨"
      - "é‡æ–°è¯»å– Profile MCP é…ç½®"
      - "æç¤ºç”¨æˆ·æ·»åŠ  MCP é…ç½®æˆ–ä½¿ç”¨å…¶ä»–æ–¹æ³•"
      - "è¾“å‡º: âŒ è¯¥é¡¹ç›®æœªé…ç½®æ­¤ MCP æœåŠ¡å™¨"

# ===========================================
# ä¼˜å…ˆçº§æ ‡è¯†è¯´æ˜
# ===========================================
priority_levels:
  P0: "å¼ºåˆ¶ - ä¸æ‰§è¡Œåˆ™å¤±è´¥"
  P1: "å¿…é¡» - åº”æ‰§è¡Œï¼Œé™¤éä¾‹å¤–"
  P2: "æ¨è - æœ€ä½³å®è·µ"
  P3: "å¯é€‰ - æ ¹æ®æƒ…å†µåˆ¤æ–­"

# ===========================================
# ç‰ˆæœ¬å…¼å®¹æ€§
# ===========================================
compatibility:
  copilot_instructions: ">=2.1.0"
  guidelines_v2: ">=2.1.0"
  profiles: ">=1.0.0"
