# v3 è„šæœ¬è§„èŒƒ

> **æ–‡ä»¶**: specs/rules/è„šæœ¬è§„èŒƒ.md  
> **ç‰ˆæœ¬**: v3.0  
> **æ—¥æœŸ**: 2025-11-20  
> **è¯´æ˜**: AI ç”Ÿæˆè„šæœ¬çš„è§„èŒƒ

---

## ğŸ“‘ ç›®å½•å¯¼èˆª

> ğŸ”´ = å¿…é¡»éµå®ˆ | ğŸŸ¡ = å»ºè®®éµå®ˆ | ğŸŸ¢ = å‚è€ƒ

- [è„šæœ¬ç±»å‹](#-è„šæœ¬ç±»å‹) ğŸ”´ - æŒ‰åŠŸèƒ½åˆ†ç±»
  - [æŒ‰åŠŸèƒ½åˆ†ç±»](#æŒ‰åŠŸèƒ½åˆ†ç±») ğŸ”´ - æ•°æ®å¤„ç†/éƒ¨ç½²/æµ‹è¯•/å·¥å…·è„šæœ¬
- [æ–‡ä»¶å‘½åå’Œä½ç½®](#-æ–‡ä»¶å‘½åå’Œä½ç½®) ğŸ”´ - scripts/{æ¨¡å—å}-{åŠŸèƒ½}.jsï¼ˆå¼ºåˆ¶ï¼‰
  - [å‘½åè§„èŒƒ](#å‘½åè§„èŒƒ) ğŸ”´ - kebab-caseå‘½å
  - [å­˜å‚¨ä½ç½®](#å­˜å‚¨ä½ç½®) ğŸ”´ - scripts/ç›®å½•
- [è¯­è¨€é€‰æ‹©å¼ºåˆ¶è§„åˆ™](#-è¯­è¨€é€‰æ‹©å¼ºåˆ¶è§„åˆ™) ğŸ”´ - è„šæœ¬/æµ‹è¯•/ç¤ºä¾‹å¿…é¡».jsï¼Œä¸šåŠ¡ä»£ç æ ¹æ®é¡¹ç›®
- [JavaScript/TypeScript è„šæœ¬è§„èŒƒ](#-javascripttypescript-è„šæœ¬è§„èŒƒ) ğŸ”´ - Node.jsè„šæœ¬æ ‡å‡†
  - [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„) ğŸ”´ - Shebang/æ³¨é‡Š/å‡½æ•°/æ‰§è¡Œ
  - [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†) ğŸ”´ - try-catch + process.exit
  - [æ—¥å¿—è¾“å‡º](#æ—¥å¿—è¾“å‡º) ğŸ”´ - console.log/error/warn
- [Shell è„šæœ¬è§„èŒƒ](#-shell-è„šæœ¬è§„èŒƒ) ğŸŸ¡ - Bashè„šæœ¬æ ‡å‡†
  - [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„-1) ğŸŸ¡ - Shebang/æ³¨é‡Š/å‡½æ•°/æ‰§è¡Œ
  - [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†-1) ğŸŸ¡ - set -e + trap
  - [æ—¥å¿—è¾“å‡º](#æ—¥å¿—è¾“å‡º-1) ğŸŸ¡ - echoå‘½ä»¤
- [Python è„šæœ¬è§„èŒƒ](#-python-è„šæœ¬è§„èŒƒ) ğŸŸ¡ - Python3è„šæœ¬æ ‡å‡†
  - [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„-2) ğŸŸ¡ - Shebang/æ³¨é‡Š/å‡½æ•°/main
  - [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†-2) ğŸŸ¡ - try-except + sys.exit
  - [æ—¥å¿—è¾“å‡º](#æ—¥å¿—è¾“å‡º-2) ğŸŸ¡ - loggingæ¨¡å—
- [é€šç”¨è¦æ±‚](#-é€šç”¨è¦æ±‚) ğŸ”´ - æ‰€æœ‰è„šæœ¬å¿…é¡»åŒ…å«
- [è„šæœ¬æ–‡æ¡£](#-è„šæœ¬æ–‡æ¡£) ğŸŸ¡ - è„šæœ¬è¯´æ˜æ–‡æ¡£
- [Profile ä¼˜å…ˆ](#-profile-ä¼˜å…ˆ)

---

## ğŸ“‹ è„šæœ¬ç±»å‹

### æŒ‰åŠŸèƒ½åˆ†ç±»

```yaml
æ„å»ºè„šæœ¬:
  - build.js: æ„å»ºé¡¹ç›®
  - watch.js: ç›‘å¬æ–‡ä»¶å˜åŒ–
  - bundle.js: æ‰“åŒ…èµ„æº

è¿ç§»è„šæœ¬:
  - migrate.js: æ•°æ®åº“è¿ç§»
  - seed.js: æ•°æ®å¡«å……
  - rollback.js: å›æ»š

éƒ¨ç½²è„šæœ¬:
  - deploy.js: éƒ¨ç½²åº”ç”¨
  - rollback-deploy.js: å›æ»šéƒ¨ç½²
  - health-check.js: å¥åº·æ£€æŸ¥

æ•°æ®å¤„ç†è„šæœ¬:
  - import.js: æ•°æ®å¯¼å…¥
  - export.js: æ•°æ®å¯¼å‡º
  - transform.js: æ•°æ®è½¬æ¢
  - cleanup.js: æ•°æ®æ¸…ç†

å·¥å…·è„šæœ¬:
  - test.js: è¿è¡Œæµ‹è¯•
  - lint.js: ä»£ç æ£€æŸ¥
  - format.js: ä»£ç æ ¼å¼åŒ–
  - docs.js: ç”Ÿæˆæ–‡æ¡£
```

---

## ğŸ“ æ–‡ä»¶å‘½åå’Œä½ç½®

### å‘½åè§„èŒƒ

```yaml
æ ¼å¼: {æ¨¡å—å}-{åŠŸèƒ½}.{ext}

ç¤ºä¾‹:
  user-auth-build.js
  order-migrate.js
  payment-deploy.js
  data-import.js

è¯­è¨€æ‰©å±•å:
  - .js: JavaScript âœ… å¼ºåˆ¶è¦æ±‚ï¼ˆè„šæœ¬æ–‡ä»¶ï¼‰
  - .sh: Shell script ï¼ˆå¯é€‰ï¼‰
  - .py: Python ï¼ˆå¯é€‰ï¼‰

ä½ç½®:
  scripts/ ç›®å½•ï¼ˆä¸æŒ‰æ¨¡å—åˆ†å­ç›®å½•ï¼‰

ğŸ”´ é‡è¦è§„åˆ™:
  1. è„šæœ¬æ–‡ä»¶ï¼ˆscripts/ï¼‰: å¿…é¡»ä½¿ç”¨ .js
  2. æµ‹è¯•æ–‡ä»¶ï¼ˆtest/ï¼‰: å¿…é¡»ä½¿ç”¨ .js
  3. ç¤ºä¾‹æ–‡ä»¶ï¼ˆexamples/ï¼‰: å¿…é¡»ä½¿ç”¨ .js
  4. ä¸šåŠ¡ä»£ç ï¼ˆsrc/app/ï¼‰: æ ¹æ®é¡¹ç›®è§„èŒƒï¼ˆå¯ä»¥æ˜¯ .ts/.js ç­‰ï¼‰

åŸå› :
  - è„šæœ¬/æµ‹è¯•/ç¤ºä¾‹æ–‡ä»¶ä½¿ç”¨ .js ç¡®ä¿:
    â€¢ æ— éœ€ç¼–è¯‘ï¼Œç›´æ¥æ‰§è¡Œ
    â€¢ é¿å…è¿è¡Œæ—¶ä¾èµ– ts-node
    â€¢ é™ä½æ‰§è¡Œå¤æ‚åº¦
    â€¢ ç”Ÿäº§ç¯å¢ƒæ›´ç¨³å®š
  - ä¸šåŠ¡ä»£ç å¯æ ¹æ®é¡¹ç›®éœ€è¦ä½¿ç”¨ TypeScript ç­‰
```

### è¯­è¨€é€‰æ‹©ä¼˜å…ˆçº§

```yaml
ğŸ”´ å¼ºåˆ¶è§„åˆ™ï¼ˆä¸å¯è¦†ç›–ï¼‰:
  è„šæœ¬æ–‡ä»¶: å¿…é¡»ä½¿ç”¨ .jsï¼ˆscripts/ç›®å½•ï¼‰
  æµ‹è¯•æ–‡ä»¶: å¿…é¡»ä½¿ç”¨ .jsï¼ˆtest/ç›®å½•ï¼‰
  ç¤ºä¾‹æ–‡ä»¶: å¿…é¡»ä½¿ç”¨ .jsï¼ˆexamples/ç›®å½•ï¼‰

ä¸šåŠ¡ä»£ç è¯­è¨€é€‰æ‹©ä¼˜å…ˆçº§:
  1. Profile æŒ‡å®šçš„è¯­è¨€ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
  2. é¡¹ç›®å·²æœ‰ä»£ç çš„è¯­è¨€ï¼ˆpackage.json åˆ†æï¼‰
  3. é»˜è®¤ JavaScript

ç¤ºä¾‹:
  âœ… æ­£ç¡®:
    scripts/user-auth-build.js      # è„šæœ¬å¿…é¡» .js
    test/user-unit.test.js          # æµ‹è¯•å¿…é¡» .js
    examples/user-demo.js           # ç¤ºä¾‹å¿…é¡» .js
    src/user.ts                     # ä¸šåŠ¡ä»£ç å¯ä»¥ .ts
    app/controller/user.ts          # ä¸šåŠ¡ä»£ç å¯ä»¥ .ts
  
  âŒ é”™è¯¯:
    scripts/user-auth-build.ts      # è„šæœ¬ä¸èƒ½ç”¨ .ts
    test/user-unit.test.ts          # æµ‹è¯•ä¸èƒ½ç”¨ .ts
    examples/user-demo.ts           # ç¤ºä¾‹ä¸èƒ½ç”¨ .ts
```

---

## ğŸ”§ JavaScript/TypeScript è„šæœ¬è§„èŒƒ

### åŸºæœ¬ç»“æ„

```javascript
#!/usr/bin/env node

/**
 * ç”¨æˆ·è®¤è¯æ¨¡å—æ„å»ºè„šæœ¬
 * 
 * åŠŸèƒ½: æ„å»ºç”¨æˆ·è®¤è¯æ¨¡å—
 * ç”¨æ³•: node scripts/user-auth-build.js [options]
 * 
 * Options:
 *   --env <env>     ç¯å¢ƒ (dev/test/prod)
 *   --clean         æ¸…ç†æ„å»ºäº§ç‰©
 *   --watch         ç›‘å¬æ–‡ä»¶å˜åŒ–
 *   --help          æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
 */

const path = require('path');
const fs = require('fs');

// ============================================
// é…ç½®
// ============================================

const config = {
  env: process.env.NODE_ENV || 'development',
  srcDir: path.join(__dirname, '../src/user-auth'),
  distDir: path.join(__dirname, '../dist/user-auth'),
  clean: false,
  watch: false
};

// ============================================
// å‚æ•°è§£æ
// ============================================

function parseArgs() {
  const args = process.argv.slice(2);
  
  for (let i = 0; i < args.length; i++) {
    switch (args[i]) {
      case '--env':
        config.env = args[++i];
        break;
      case '--clean':
        config.clean = true;
        break;
      case '--watch':
        config.watch = true;
        break;
      case '--help':
        showHelp();
        process.exit(0);
      default:
        console.error(`Unknown option: ${args[i]}`);
        showHelp();
        process.exit(1);
    }
  }
}

function showHelp() {
  console.log(`
Usage: node scripts/user-auth-build.js [options]

Options:
  --env <env>     Environment (dev/test/prod)
  --clean         Clean build output
  --watch         Watch for file changes
  --help          Show this help message
  `);
}

// ============================================
// æ ¸å¿ƒåŠŸèƒ½
// ============================================

async function build() {
  console.log('ğŸ”¨ Starting build...');
  console.log(`Environment: ${config.env}`);
  
  try {
    // 1. æ¸…ç†
    if (config.clean) {
      await clean();
    }
    
    // 2. åˆ›å»ºè¾“å‡ºç›®å½•
    if (!fs.existsSync(config.distDir)) {
      fs.mkdirSync(config.distDir, { recursive: true });
    }
    
    // 3. æ„å»º
    await compile();
    
    // 4. å¤åˆ¶èµ„æº
    await copyAssets();
    
    console.log('âœ… Build completed successfully!');
  } catch (error) {
    console.error('âŒ Build failed:', error.message);
    process.exit(1);
  }
}

async function clean() {
  console.log('ğŸ§¹ Cleaning build output...');
  if (fs.existsSync(config.distDir)) {
    fs.rmSync(config.distDir, { recursive: true });
  }
}

async function compile() {
  console.log('âš™ï¸ Compiling...');
  // å®ç°ç¼–è¯‘é€»è¾‘
}

async function copyAssets() {
  console.log('ğŸ“¦ Copying assets...');
  // å®ç°èµ„æºå¤åˆ¶é€»è¾‘
}

// ============================================
// ä¸»å…¥å£
// ============================================

async function main() {
  parseArgs();
  await build();
}

// è¿è¡Œ
if (require.main === module) {
  main().catch(error => {
    console.error('Unexpected error:', error);
    process.exit(1);
  });
}

module.exports = { build, clean };
```

### å¿…é¡»åŒ…å«çš„éƒ¨åˆ†

```yaml
Shebang:
  - #!/usr/bin/env node
  - ä½¿è„šæœ¬å¯ç›´æ¥æ‰§è¡Œ

æ–‡ä»¶æ³¨é‡Š:
  - è„šæœ¬åŠŸèƒ½è¯´æ˜
  - ç”¨æ³•ç¤ºä¾‹
  - å‚æ•°è¯´æ˜

é…ç½®éƒ¨åˆ†:
  - é›†ä¸­é…ç½®
  - ä½¿ç”¨constå®šä¹‰
  - è·¯å¾„ä½¿ç”¨path.join

å‚æ•°è§£æ:
  - æ”¯æŒå‘½ä»¤è¡Œå‚æ•°
  - æä¾›--helpé€‰é¡¹
  - å‚æ•°éªŒè¯

é”™è¯¯å¤„ç†:
  - try-catchåŒ…è£¹
  - æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
  - éé›¶é€€å‡ºç 

æ—¥å¿—è¾“å‡º:
  - ä½¿ç”¨emojiå›¾æ ‡
  - æ¸…æ™°çš„è¿›åº¦æç¤º
  - é”™è¯¯é«˜äº®æ˜¾ç¤º
```

---

## ğŸš Shell è„šæœ¬è§„èŒƒ

### åŸºæœ¬ç»“æ„

```bash
#!/bin/bash

# ============================================
# ç”¨æˆ·è®¤è¯æ¨¡å—æ„å»ºè„šæœ¬
# ============================================
# åŠŸèƒ½: æ„å»ºç”¨æˆ·è®¤è¯æ¨¡å—
# ç”¨æ³•: ./scripts/user-auth-build.sh [options]
#
# Options:
#   -e, --env <env>     ç¯å¢ƒ (dev/test/prod)
#   -c, --clean         æ¸…ç†æ„å»ºäº§ç‰©
#   -w, --watch         ç›‘å¬æ–‡ä»¶å˜åŒ–
#   -h, --help          æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
# ============================================

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º
set -u  # ä½¿ç”¨æœªå®šä¹‰å˜é‡æ—¶æŠ¥é”™
set -o pipefail  # ç®¡é“å‘½ä»¤å¤±è´¥æ—¶æŠ¥é”™

# ============================================
# é…ç½®
# ============================================

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"
SRC_DIR="$PROJECT_ROOT/src/user-auth"
DIST_DIR="$PROJECT_ROOT/dist/user-auth"

ENV="${ENV:-development}"
CLEAN=false
WATCH=false

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# ============================================
# å·¥å…·å‡½æ•°
# ============================================

log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

show_help() {
    cat << EOF
Usage: $0 [options]

Options:
  -e, --env <env>     Environment (dev/test/prod)
  -c, --clean         Clean build output
  -w, --watch         Watch for file changes
  -h, --help          Show this help message
EOF
}

check_dependencies() {
    local missing_deps=()
    
    for cmd in node npm; do
        if ! command -v "$cmd" &> /dev/null; then
            missing_deps+=("$cmd")
        fi
    done
    
    if [ ${#missing_deps[@]} -ne 0 ]; then
        log_error "Missing dependencies: ${missing_deps[*]}"
        log_error "Please install them first."
        exit 1
    fi
}

# ============================================
# æ ¸å¿ƒåŠŸèƒ½
# ============================================

clean() {
    log_info "ğŸ§¹ Cleaning build output..."
    if [ -d "$DIST_DIR" ]; then
        rm -rf "$DIST_DIR"
    fi
}

build() {
    log_info "ğŸ”¨ Starting build..."
    log_info "Environment: $ENV"
    
    # æ¸…ç†ï¼ˆå¦‚æœéœ€è¦ï¼‰
    if [ "$CLEAN" = true ]; then
        clean
    fi
    
    # åˆ›å»ºè¾“å‡ºç›®å½•
    mkdir -p "$DIST_DIR"
    
    # ç¼–è¯‘
    log_info "âš™ï¸ Compiling..."
    npm run compile
    
    # å¤åˆ¶èµ„æº
    log_info "ğŸ“¦ Copying assets..."
    cp -r "$SRC_DIR/assets" "$DIST_DIR/"
    
    log_info "âœ… Build completed successfully!"
}

# ============================================
# å‚æ•°è§£æ
# ============================================

while [[ $# -gt 0 ]]; do
    case $1 in
        -e|--env)
            ENV="$2"
            shift 2
            ;;
        -c|--clean)
            CLEAN=true
            shift
            ;;
        -w|--watch)
            WATCH=true
            shift
            ;;
        -h|--help)
            show_help
            exit 0
            ;;
        *)
            log_error "Unknown option: $1"
            show_help
            exit 1
            ;;
    esac
done

# ============================================
# ä¸»å…¥å£
# ============================================

main() {
    check_dependencies
    build
}

# è¿è¡Œ
main
```

### å¿…é¡»åŒ…å«çš„éƒ¨åˆ†

```yaml
Shebang:
  - #!/bin/bash
  - æ˜ç¡®æŒ‡å®šè§£é‡Šå™¨

é”™è¯¯å¤„ç†:
  - set -e: é‡åˆ°é”™è¯¯é€€å‡º
  - set -u: æœªå®šä¹‰å˜é‡æŠ¥é”™
  - set -o pipefail: ç®¡é“å¤±è´¥æŠ¥é”™

è·¯å¾„å¤„ç†:
  - SCRIPT_DIRè·å–è„šæœ¬ç›®å½•
  - ä½¿ç”¨ç»å¯¹è·¯å¾„
  - è·¯å¾„å˜é‡å…¨å¤§å†™

æ—¥å¿—å‡½æ•°:
  - log_info: ä¿¡æ¯
  - log_warn: è­¦å‘Š
  - log_error: é”™è¯¯
  - ä½¿ç”¨é¢œè‰²åŒºåˆ†

ä¾èµ–æ£€æŸ¥:
  - check_dependencieså‡½æ•°
  - åœ¨mainå¼€å§‹æ—¶è°ƒç”¨
  - ç¼ºå¤±æ—¶æ¸…æ™°æç¤º
```

---

## ğŸ Python è„šæœ¬è§„èŒƒ

### åŸºæœ¬ç»“æ„

```python
#!/usr/bin/env python3

"""
ç”¨æˆ·è®¤è¯æ¨¡å—æ„å»ºè„šæœ¬

åŠŸèƒ½: æ„å»ºç”¨æˆ·è®¤è¯æ¨¡å—
ç”¨æ³•: python scripts/user-auth-build.py [options]

Options:
  --env <env>     ç¯å¢ƒ (dev/test/prod)
  --clean         æ¸…ç†æ„å»ºäº§ç‰©
  --watch         ç›‘å¬æ–‡ä»¶å˜åŒ–
  --help          æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
"""

import os
import sys
import argparse
import shutil
from pathlib import Path
from typing import Optional

# ============================================
# é…ç½®
# ============================================

SCRIPT_DIR = Path(__file__).parent
PROJECT_ROOT = SCRIPT_DIR.parent
SRC_DIR = PROJECT_ROOT / 'src' / 'user-auth'
DIST_DIR = PROJECT_ROOT / 'dist' / 'user-auth'

# é¢œè‰²ä»£ç 
class Color:
    RED = '\033[0;31m'
    GREEN = '\033[0;32m'
    YELLOW = '\033[1;33m'
    NC = '\033[0m'  # No Color

# ============================================
# å·¥å…·å‡½æ•°
# ============================================

def log_info(message: str) -> None:
    """è¾“å‡ºä¿¡æ¯æ—¥å¿—"""
    print(f"{Color.GREEN}[INFO]{Color.NC} {message}")

def log_warn(message: str) -> None:
    """è¾“å‡ºè­¦å‘Šæ—¥å¿—"""
    print(f"{Color.YELLOW}[WARN]{Color.NC} {message}")

def log_error(message: str) -> None:
    """è¾“å‡ºé”™è¯¯æ—¥å¿—"""
    print(f"{Color.RED}[ERROR]{Color.NC} {message}", file=sys.stderr)

def check_dependencies() -> bool:
    """æ£€æŸ¥ä¾èµ–"""
    missing_deps = []
    
    for cmd in ['node', 'npm']:
        if shutil.which(cmd) is None:
            missing_deps.append(cmd)
    
    if missing_deps:
        log_error(f"Missing dependencies: {', '.join(missing_deps)}")
        log_error("Please install them first.")
        return False
    
    return True

# ============================================
# æ ¸å¿ƒåŠŸèƒ½
# ============================================

def clean() -> None:
    """æ¸…ç†æ„å»ºäº§ç‰©"""
    log_info("ğŸ§¹ Cleaning build output...")
    if DIST_DIR.exists():
        shutil.rmtree(DIST_DIR)

def build(env: str, should_clean: bool, watch: bool) -> None:
    """æ„å»ºé¡¹ç›®"""
    log_info("ğŸ”¨ Starting build...")
    log_info(f"Environment: {env}")
    
    try:
        # æ¸…ç†
        if should_clean:
            clean()
        
        # åˆ›å»ºè¾“å‡ºç›®å½•
        DIST_DIR.mkdir(parents=True, exist_ok=True)
        
        # ç¼–è¯‘
        log_info("âš™ï¸ Compiling...")
        compile_project()
        
        # å¤åˆ¶èµ„æº
        log_info("ğŸ“¦ Copying assets...")
        copy_assets()
        
        log_info("âœ… Build completed successfully!")
    except Exception as e:
        log_error(f"Build failed: {str(e)}")
        sys.exit(1)

def compile_project() -> None:
    """ç¼–è¯‘é¡¹ç›®"""
    # å®ç°ç¼–è¯‘é€»è¾‘
    pass

def copy_assets() -> None:
    """å¤åˆ¶èµ„æºæ–‡ä»¶"""
    # å®ç°èµ„æºå¤åˆ¶é€»è¾‘
    pass

# ============================================
# å‚æ•°è§£æ
# ============================================

def parse_args() -> argparse.Namespace:
    """è§£æå‘½ä»¤è¡Œå‚æ•°"""
    parser = argparse.ArgumentParser(
        description='ç”¨æˆ·è®¤è¯æ¨¡å—æ„å»ºè„šæœ¬',
        formatter_class=argparse.RawDescriptionHelpFormatter
    )
    
    parser.add_argument(
        '--env',
        default='development',
        choices=['dev', 'test', 'staging', 'prod'],
        help='Environment (dev/test/staging/prod)'
    )
    parser.add_argument(
        '--clean',
        action='store_true',
        help='Clean build output'
    )
    parser.add_argument(
        '--watch',
        action='store_true',
        help='Watch for file changes'
    )
    
    return parser.parse_args()

# ============================================
# ä¸»å…¥å£
# ============================================

def main() -> int:
    """ä¸»å‡½æ•°"""
    args = parse_args()
    
    # æ£€æŸ¥ä¾èµ–
    if not check_dependencies():
        return 1
    
    # æ„å»º
    build(args.env, args.clean, args.watch)
    
    return 0

if __name__ == '__main__':
    sys.exit(main())
```

### å¿…é¡»åŒ…å«çš„éƒ¨åˆ†

```yaml
Shebang:
  - #!/usr/bin/env python3
  - ä½¿ç”¨Python 3

Docstring:
  - æ¨¡å—çº§docstring
  - å‡½æ•°docstring
  - ç±»å‹æ³¨è§£

è·¯å¾„å¤„ç†:
  - ä½¿ç”¨pathlib.Path
  - ç›¸å¯¹äºè„šæœ¬çš„è·¯å¾„

æ—¥å¿—å‡½æ•°:
  - log_info/log_warn/log_error
  - ä½¿ç”¨é¢œè‰²åŒºåˆ†

å‚æ•°è§£æ:
  - ä½¿ç”¨argparse
  - æä¾›helpä¿¡æ¯
  - å‚æ•°éªŒè¯

è¿”å›å€¼:
  - mainè¿”å›int
  - æˆåŠŸè¿”å›0
  - å¤±è´¥è¿”å›éé›¶
```

---

## ğŸ“ è„šæœ¬æ–‡æ¡£

### è„šæœ¬æ³¨é‡Š

```javascript
/**
 * ç”¨æˆ·è®¤è¯æ¨¡å—æ„å»ºè„šæœ¬
 * 
 * åŠŸèƒ½:
 * - ç¼–è¯‘TypeScriptä»£ç 
 * - å¤åˆ¶é™æ€èµ„æº
 * - ç”ŸæˆSource Maps
 * 
 * ç”¨æ³•:
 *   node scripts/user-auth-build.js
 *   node scripts/user-auth-build.js --env prod
 *   node scripts/user-auth-build.js --clean --watch
 * 
 * é€‰é¡¹:
 *   --env <env>     ç¯å¢ƒ (dev/test/prod)
 *   --clean         æ¸…ç†æ„å»ºäº§ç‰©
 *   --watch         ç›‘å¬æ–‡ä»¶å˜åŒ–
 *   --help          æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
 * 
 * ä¾èµ–:
 *   - Node.js >= 14
 *   - npm >= 6
 * 
 * è¾“å‡º:
 *   dist/user-auth/
 * 
 * é”™è¯¯ç :
 *   0 - æˆåŠŸ
 *   1 - é€šç”¨é”™è¯¯
 *   2 - å‚æ•°é”™è¯¯
 * 
 * ç¤ºä¾‹:
 *   # å¼€å‘ç¯å¢ƒæ„å»º
 *   npm run build:dev
 *   
 *   # ç”Ÿäº§ç¯å¢ƒæ„å»ºï¼ˆæ¸…ç†+æ„å»ºï¼‰
 *   npm run build:prod -- --clean
 * 
 * @author AI
 * @date 2025-11-20
 */
```

### README.md ä¸­çš„è„šæœ¬è¯´æ˜

```markdown
## è„šæœ¬

### æ„å»ºè„šæœ¬

\`\`\`bash
# å¼€å‘ç¯å¢ƒæ„å»º
node scripts/user-auth-build.js --env dev

# ç”Ÿäº§ç¯å¢ƒæ„å»º
node scripts/user-auth-build.js --env prod --clean
\`\`\`

### è¿ç§»è„šæœ¬

\`\`\`bash
# è¿è¡Œè¿ç§»
node scripts/order-migrate.js up

# å›æ»šè¿ç§»
node scripts/order-migrate.js down
\`\`\`

### éƒ¨ç½²è„šæœ¬

\`\`\`bash
# éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
./scripts/payment-deploy.sh --env test

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
./scripts/payment-deploy.sh --env prod
\`\`\`
```

---

## âš ï¸ å®‰å…¨è§„èŒƒ

### ç¦æ­¢ç¡¬ç¼–ç 

```yaml
âŒ ç¦æ­¢ç¡¬ç¼–ç :
  - å¯†ç 
  - APIå¯†é’¥
  - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
  - æœåŠ¡å™¨åœ°å€ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡:
  const apiKey = process.env.API_KEY;
  const dbUrl = process.env.DATABASE_URL;
```

### è¾“å…¥éªŒè¯

```javascript
function validateEnv(env) {
  const validEnvs = ['dev', 'test', 'staging', 'prod'];
  if (!validEnvs.includes(env)) {
    throw new Error(
      `Invalid environment: ${env}\n` +
      `Must be one of: ${validEnvs.join(', ')}`
    );
  }
}

function validatePath(filePath) {
  const resolvedPath = path.resolve(filePath);
  const projectRoot = path.resolve(__dirname, '..');
  
  if (!resolvedPath.startsWith(projectRoot)) {
    throw new Error('Path traversal detected!');
  }
  
  return resolvedPath;
}
```

### æƒé™æ£€æŸ¥

```javascript
function checkPermissions(filePath) {
  try {
    fs.accessSync(filePath, fs.constants.W_OK);
  } catch (error) {
    throw new Error(`No write permission for: ${filePath}`);
  }
}
```

---

## ğŸ§ª è„šæœ¬æµ‹è¯•

### æµ‹è¯•è„šæœ¬

```javascript
// scripts/__tests__/user-auth-build.test.js

const { build, clean } = require('../user-auth-build');
const fs = require('fs');
const path = require('path');

describe('user-auth-build', () => {
  const testDistDir = path.join(__dirname, 'test-dist');
  
  afterEach(async () => {
    // æ¸…ç†æµ‹è¯•äº§ç‰©
    if (fs.existsSync(testDistDir)) {
      fs.rmSync(testDistDir, { recursive: true });
    }
  });
  
  test('should build successfully', async () => {
    await build();
    expect(fs.existsSync(testDistDir)).toBe(true);
  });
  
  test('should clean build output', async () => {
    fs.mkdirSync(testDistDir, { recursive: true });
    await clean();
    expect(fs.existsSync(testDistDir)).toBe(false);
  });
});
```

---

## ğŸ“Š è„šæœ¬è´¨é‡æ£€æŸ¥

### æ£€æŸ¥æ¸…å•

```yaml
âœ… å¿…é¡»æ£€æŸ¥:
  - Shebangæ­£ç¡®
  - æ–‡ä»¶æ³¨é‡Šå®Œæ•´
  - å‚æ•°è§£æå®Œå–„
  - é”™è¯¯å¤„ç†åˆ°ä½
  - æ—¥å¿—è¾“å‡ºæ¸…æ™°
  - ä¾èµ–æ£€æŸ¥å®Œæ•´
  - è·¯å¾„å¤„ç†å®‰å…¨
  - é€€å‡ºç æ­£ç¡®
  - å¸®åŠ©ä¿¡æ¯å®Œæ•´
  - å¯æ‰§è¡Œæƒé™ï¼ˆUnixï¼‰
```

---

**æ–‡ä»¶åˆ›å»º**: 2025-11-20  
**æœ€åæ›´æ–°**: 2025-11-20  
**çŠ¶æ€**: âœ… å®Œæ•´

